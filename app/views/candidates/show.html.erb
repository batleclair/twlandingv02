<% c_pic = @candidate.photo.attached? ? cl_image_tag(@candidate.photo.key, class: "big-rounded-avatar twist subtle-shadow", angle: 5, width: 180, height: 180, gravity: "faces", crop: "fill") : cl_image_tag('../no_avatar.png', class: "twisted-avatar subtle-shadow", transformation: [{angle: 5}]) %>

<div class="shaded-wrapper-sm d-flex align-items-center">
  <%= c_pic %>
  <div class="p-4 flex-grow-1">
    <h5 class="primary-text-color bold-6"><%= @candidate.user.first_name %></h5>
    <h6 class="mb-3"><%= "#{@candidate.title}, #{@candidate.location}" %></h5>
    <% case @candidate.status %>
    <% when 'ft_employee' %>
      <p>ğŸ’¼ SalariÃ©Â·e souhaitant sâ€™engager sur son temps de travail</p>
      <p>Employeur : <strong><%= @candidate.employer_name.upcase %></strong></p>
        <% if @candidate.employer_approved %>
          <p class="green-color"><i class="fa-solid fa-circle-check"></i> approuvÃ© par lâ€™entreprise</p>
        <% else %>
          <p class="grey-color"><i class="fa-solid fa-circle-question"></i> pas encore approuvÃ© par l'entreprise</p>
        <% end %>
    <% when 'pt_employee' %>
      <p>ğŸ’¼ SalariÃ©Â·e Ã  temps partiel</p>
    <% when 'freelance' %>
      <p>ğŸ’¼ IndÃ©pÃ©endantÂ·e</p>
    <% else %>
      <p>ğŸ’¼ CandidatÂ·e</p>
    <% end %>
  </div>
  <div>
    <%= link_to 'Editer profil', edit_candidate_path(@candidate), class: "button btn-flag-color" %>
  </div>
</div>

<div class="flex-resp">
    <div class="main-2flex-wrapper">
      <h5 class="primary-text-color bold-6 mb-3">moi</h5>
      <p><%= @candidate.description %></p>
      <h5 class="primary-text-color bold-6 mt-5 mb-3">j'ai travaillÃ© pour</h5>

      <div class="full-width mb-2">
        <% @candidate.experiences.order(start_date: :desc).each do |xp| %>

            <div class="d-flex align-items-top justify-content-between full-width">

              <div class="set-width-150 me-3">
                <div class="d-flex align-items-center">

                  <% if xp.end_date.present? %>
                    <p class="me-2 sm-thin-text">(<%= xp.start_date_output %></p>
                    <i class="fa-solid fa-arrow-right-long me-2 primary-text-color"></i>
                    <p class="sm-thin-text"><%= xp.end_date_output %>)</p>
                  <% else %>
                    <p class="me-2 sm-thin-text">depuis <%= xp.start_date_output %></p>
                  <% end %>

                </div>
                <p><%= "#{xp.duration[:years]} ans" unless xp.duration[:years] == 0 %> <%= "#{xp.duration[:months]} mois" unless xp.duration[:months] == 0 %></p>
              </div>

              <div class="flex-resp align-items-center flex-grow-1">
                <h6 class="me-4 set-width-150"><%= xp.employer %>: </h6>
                <p><%= xp.title %></p>
              </div>

            </div>

        <% end %>
      </div>



      <h5 class="primary-text-color bold-6 mt-5 mb-3">mes compÃ©tences</h5>
      <div class="d-flex mb-2">
        <h6 class="me-2">domaine :</h6>
        <h6 class="stress"><%= @candidate.function %></h6>
      </div>
      <ul class="pill-tag-list">
        <% @candidate.skill_list.each do |skill| %>
          <li class="me-1 mt-1"><%= skill %></li>
        <% end %>
      </ul>
      <h5 class="primary-text-color bold-6 mt-5 mb-3">je veux / peux aider</h5>
      <h5 class="primary-text-color bold-6 mt-5 mb-3">je suis sensible Ã </h5>
      <ul class="badge-list-ctn">
        <% @candidate.cause_list.each do |cause| %>
          <li class="mt-1"><%= cause %></li>
        <% end %>
      </ul>
    </div>
    <div class="side-2flex-wrapper">
      <h5 class="primary-text-color bold-6 mb-3">Ã§a peut t'intÃ©resser</h5>
      <h6 class="mb-2">dans ton domaine</h6>
      <div>
        <% @offers.each do |offer| %>
          <%= link_to offer_path(offer) do %>
            <div class="job-card-sm subtle-shadow mb-3">
              <h6 class="primary-text-color mb-2"><%= offer.title %></h6>
              <p><%= offer.beneficiary.name %></p>
            </div>
          <% end %>
        <% end %>
        <div class="d-flex justify-content-end">
          <%= link_to 'voir plus', offers_path, class: 'color-link' %>
        </div>
      </div>
    </div>


</div>
