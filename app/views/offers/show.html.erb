<% bg_img = @offer.beneficiary.photo.attached? ? cl_image_path(@offer.beneficiary.photo.key) : image_path('bannerbg.jpg') %>
<% b_logo = @offer.beneficiary.logo.attached? ? cl_image_tag(@offer.beneficiary.logo.key) : image_tag('illustration5.png') %>


<div style="background-image: linear-gradient(45deg, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.6)), url('<%= bg_img %>')" class="offer-banner">
  <div class="logo-box mb-3">
    <%= b_logo %>
  </div>
  <h2><%= @offer.title %></h2>
  <div class="offer-specs">
    <ul class="list-inline">
      <li>📍 Lieu : <%= @offer.location %></li>

      <% case
      when @offer.half_days_min.nil? && @offer.half_days_max.nil?
        f = "à définir"
      when  ( @offer.half_days_min.nil? && !@offer.half_days_max.nil? ) || @offer.half_days_min == @offer.half_days_max
        f = "#{@offer.half_days_max.fdiv(2).round(1).to_s.chomp('.0')} j / sem"
      when  ( !@offer.half_days_min.nil? && @offer.half_days_max.nil? )
        f = "#{@offer.half_days_min.fdiv(2).round(1).to_s.chomp('.0')} j / sem"
      else
        f = "#{@offer.half_days_min.fdiv(2).round(1).to_s.chomp('.0')} à #{@offer.half_days_max.fdiv(2).round(1).to_s.chomp('.0')} j / sem"
      end %>

      <li class="ps-3 pe-3">🕐 Fréquence : <%= f %></li>

      <% case
      when @offer.months_min.nil? && @offer.months_max.nil?
        d = "à définir"
      when  ( @offer.months_min.nil? && !@offer.months_max.nil? ) || @offer.months_min == @offer.months_max
        d = "#{@offer.months_max} mois"
      when  ( !@offer.months_min.nil? && @offer.months_max.nil? )
        d = "#{@offer.months_min} mois"
      else
        d = "#{@offer.months_min} à #{@offer.months_max} mois"
      end %>

      <li>📅 Durée : <%= d %></li>
    </ul>
  </div>
</div>


<div class="white-wrapper">
  <div class="resp-flex-ctn">
    <div class="toggle-sm sticky-btn">
      <%= render partial: "apply", locals: {offer: @offer} %>
    </div>
    <div>
      <h4 class="mb-4"><span class="stress"><%= @offer.title %></span></h4>
      <%= @offer.description %>
    </div>
    <div class="fixed-size-box sticky-box toggle-lg" data-controller="lock">

        <%= render partial: "apply", locals: {offer: @offer} %>
        <h5 class="text-center primary-text-color">Un impact limité sur votre rémunération !</h5>
        <h6 class="mt-3">Grâce à Demain :</h6>
        <p>Votre rémunération sera <span class="stress">au moins équivalente au cumul de 2 temps partiels</span>, l'un dans votre entreprise et l'autre chez <strong><%= @offer.beneficiary.name %></strong></p>
        <%= link_to "En savoir +", candidates_path, class: "button full-width btn-main-color mt-3" %>
          <% if user_signed_in? && policy(Offer).edit? %>
            <%= link_to edit_offer_path(@offer), class: "button full-width btn-admin-cta mt-3" do %>
              <i class="fa-solid fa-gear"></i>
              Modifier l'offre
            <% end %>
          <% end %>
    </div>
  </div>
  <div class="toggle-sm">
    <h5 class="text-center primary-text-color mt-5
    ">Un impact limité sur votre rémunération !</h5>
    <h6 class="mt-3">Grâce à Demain :</h6>
    <p>Votre rémunération sera <span class="stress">au moins équivalente au cumul de 2 temps partiels</span>, l'un dans votre entreprise et l'autre chez <strong><%= @offer.beneficiary.name %></strong></p>
    <%= link_to "En savoir +", candidates_path, class: "button full-width btn-main-color mt-3" %>
  </div>
</div>



<%= render partial: "candidacy", locals: {offer: @offer, candidacy: @candidacy} %>
