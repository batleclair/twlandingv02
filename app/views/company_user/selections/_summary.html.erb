<h5 class="mb-20"><%= selection.offer.title %></h5>

<div class="bg-grey pt-3 ps-3 pe-3 d-flex grey-id-card mb-3">
  <div class="d-flex flex-column align-items-center">
    <div class="logo-box flex-shrink-0 mg-resp-r mb-2 downsize90">
      <%= selection.offer.beneficiary.logo.attached? ? cl_image_tag(selection.offer.beneficiary.logo.key) : cl_image_tag('../default_logo.png') %>
    </div>
  </div>
  <div class="mg-resp-l position-relative">
    <h6><%= selection.offer.beneficiary.name %></h6>
    <p class="text-main mb-2">ğŸ‘Š <%= selection.offer.beneficiary.cause %></p>
    <%= selection.offer.beneficiary.description %>
    <div class="bottom-fader fade-grey"></div>
  </div>
</div>

<% if current_user.last_employee_application&.approved? %>
  <% if selection.applied? %>
    <h5>Toutes les informations sur l'avancement de votre candidature</h5>
  <% elsif selection.refused? %>
    <h5>Vous avez changÃ© d'avis ?</h5>
    <%= simple_form_for([selection.offer, candidacy], url: user_offer_candidacies_path(selection.offer)) do |f| %>
      <%= f.input :motivation_msg %>
      <%= f.submit "Candidater", class: "button btn-main-color" %>
    <% end %>
  <% else %>
    <%= simple_form_for(selection) do |f| %>
      <%= f.input :status,
                  as: :radio_buttons,
                  legend_tag: false,
                  label: false,
                  collection: selection.liked? ? [['Candidater', "accepted"], ['Retirer', "refused"]] : [['Accepter', "accepted"], ['Refuser', "refused"]],
                  required: true %>
      <%= f.input :response_msg,
                  label: "Votre message de rÃ©ponse" %>
      <button type="submit" class="button btn-main-color">Enregistrer</button>
    <% end %>
  <% end %>
<% else %>
  <% status = @selection.refused? ? nil : "refused" %>
  <% label = @selection.refused? ? "Re <3" : "Retirer des <3"  %>
  <%= button_to label, selection_path(@selection), method: :patch, params: {selection: {status: status}} %>
<% end %>
